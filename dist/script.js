(()=>{var l=document.getElementById("lightSlider"),w=document.getElementById("intensityLabel"),L=document.getElementById("lightDisplay"),u=document.getElementById("copyLinkBtn"),B=document.getElementById("resetBtn"),d=document.getElementById("intensityInput"),m=document.getElementById("themeToggleBtn"),g=document.getElementById("installBtn"),k=document.getElementById("cameraTorchBtn"),I=document.getElementById("stopCameraBtn"),a=document.getElementById("torchSupportMsg"),b=document.getElementById("screenTorchBtn"),p=document.getElementById("screenTorchLevel"),r=document.getElementById("screenTorchOverlay"),v="light-intensity",f="theme-preference";function h(e,t,n){return Math.max(t,Math.min(n,e))}function s(e){let t=h(Number(e)||0,0,255);l.value=String(t),l.setAttribute("aria-valuenow",String(t)),w.textContent=`Light Intensity: ${t}`,L.style.backgroundColor=`rgb(${t}, ${t}, ${t})`,d&&(d.value=String(t));try{localStorage.setItem(v,String(t))}catch{}let n=new URL(window.location.href);n.searchParams.set("i",String(t)),window.history.replaceState({},"",n)}function C(){let t=new URL(window.location.href).searchParams.get("i");if(t!==null)return h(Number(t),0,255);try{let n=localStorage.getItem(v);if(n!==null)return h(Number(n),0,255)}catch{}return 0}l.addEventListener("input",()=>{s(l.value)});d?.addEventListener("input",()=>{s(d.value)});u?.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(window.location.href),u.textContent="Copied!",setTimeout(()=>u.textContent="Copy link",1200)}catch{}});B?.addEventListener("click",()=>{s(0)});document.querySelectorAll(".preset").forEach(e=>{e.addEventListener("click",()=>{let t=e.getAttribute("data-value");t!=null&&s(Number(t))})});"serviceWorker"in navigator&&window.addEventListener("load",()=>{let e=new URL("sw.js",window.location.href).toString();navigator.serviceWorker.register(e).catch(()=>{})});s(C());function E(e){let t=document.documentElement;e==="auto"?t.removeAttribute("data-theme"):t.setAttribute("data-theme",e),m&&(m.textContent=`Theme: ${e[0].toUpperCase()}${e.slice(1)}`)}function T(){try{let e=localStorage.getItem(f);if(e==="light"||e==="dark"||e==="auto")return e}catch{}return"auto"}var y=T();E(y);m?.addEventListener("click",()=>{let e=["auto","light","dark"],t=e[(e.indexOf(y)+1)%e.length];y=t;try{localStorage.setItem(f,t)}catch{}E(t)});var o=null;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),o=e,g?.classList.remove("hidden")});g?.addEventListener("click",async()=>{if(!o)return;o.prompt();let{outcome:e}=await o.userChoice;e&&g.classList.add("hidden"),o=null});var i=null;async function S(){if(!("mediaDevices"in navigator)||!navigator.mediaDevices.getUserMedia){a.textContent="Camera API not supported on this device.";return}try{i=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}}});let e=i.getVideoTracks()[0];if(!("torch"in(e.getCapabilities?.()||{}))){a.textContent="Torch capability not available. Some devices/browsers do not expose it.";return}await e.applyConstraints({advanced:[{torch:!0}]}),a.textContent="Camera torch enabled. Keep the page open to maintain torch."}catch{a.textContent="Could not enable camera torch (permission or capability)."}}function x(){i&&(i.getTracks().forEach(e=>e.stop()),i=null,a.textContent="Camera stopped.")}k?.addEventListener("click",S);I?.addEventListener("click",x);var c=null;async function M(){try{"wakeLock"in navigator&&(c=await navigator.wakeLock.request("screen"),c.addEventListener("release",()=>{}))}catch{}}function A(e){if(r){if(e)r.hidden=!1,r.style.opacity="1",M();else if(r.hidden=!0,c)try{c.release()}catch{}finally{c=null}}}b?.addEventListener("click",()=>{let e=!!r&&!r.hidden;A(!e)});p?.addEventListener("input",()=>{let e=Math.max(0,Math.min(100,Number(p.value)||0));r.style.opacity=String(e/100)});})();
//# sourceMappingURL=script.js.map
